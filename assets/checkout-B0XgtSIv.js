import"./main-CaerLrfH.js";const I=2500,S="http://localhost:55482",B=`${S}/checkout/session`,g=t=>`$${t.toLocaleString("en-US")}`,p=t=>Math.max(1,Math.min(999,t|0)),C=t=>({hungary:"HU",france:"FR","united-kingdom":"GB"})[(t||"").toLowerCase()]||(t||"").toUpperCase().slice(0,2),w=new URLSearchParams(location.search),c=p(parseInt(w.get("seats")||"1",10)),i=document.getElementById("wsSubtotal"),d=document.getElementById("wsTaxes"),u=document.getElementById("wsTotal"),h=c*I;i&&(i.textContent=g(h));d&&(d.textContent="$0");u&&(u.textContent=g(h));const T=document.getElementById("email"),v=document.getElementById("street"),k=document.getElementById("city"),x=document.getElementById("postal"),b=document.getElementById("country"),m=document.getElementById("company"),y=document.getElementById("companyBlock"),r=document.getElementById("company-name"),l=document.getElementById("vatin");function E(){const t=!!m?.checked;y&&y.classList.toggle("hidden",!t),r&&(r.required=t),l&&(l.required=t)}m?.addEventListener("change",E);E();const e=document.getElementById("wsContinue");e?.addEventListener("click",async()=>{const t=document.querySelector("form");if(t&&!t.reportValidity())return;const o=JSON.parse(sessionStorage.getItem("wsCheckoutDraft")||"{}"),n={seats:p(Number.isFinite(c)?c:o?.seats??1),email:(T?.value??"").trim()||o?.customer?.email||null,billingAddress:{line1:(v?.value??"").trim(),city:(k?.value??"").trim(),postal_code:(x?.value??"").trim(),country:C(b?.value||"")},company:m?.checked?{name:(r?.value??"").trim(),vatin:(l?.value??"").trim()}:null};try{sessionStorage.setItem("wsCheckoutDraft",JSON.stringify({seats:n.seats,customer:{email:n.email},address:n.billingAddress,company:n.company}))}catch{}const f=e.textContent;e.disabled=!0,e.style.opacity="0.7",e.textContent="Processingâ€¦";try{const a=await(await fetch(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();if(a?.url)window.location.href=a.url;else throw new Error(a?.error||"Could not start payment")}catch(s){console.error(s.message||String(s)),e.disabled=!1,e.style.opacity="",e.textContent=f}});
