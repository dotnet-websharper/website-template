import{A as I}from"./main-B_efUyFN.js";const S=2500,C=`${I}/checkout/session`,g=t=>`$${t.toLocaleString("en-US")}`,p=t=>Math.max(1,Math.min(999,t|0)),B=t=>({hungary:"HU",france:"FR","united-kingdom":"GB"})[(t||"").toLowerCase()]||(t||"").toUpperCase().slice(0,2),w=new URLSearchParams(location.search),c=p(parseInt(w.get("seats")||"1",10)),l=document.getElementById("wsSubtotal"),d=document.getElementById("wsTaxes"),u=document.getElementById("wsTotal"),f=c*S;l&&(l.textContent=g(f));d&&(d.textContent="$0");u&&(u.textContent=g(f));const T=document.getElementById("email"),v=document.getElementById("street"),k=document.getElementById("city"),x=document.getElementById("postal"),b=document.getElementById("country"),i=document.getElementById("company"),y=document.getElementById("companyBlock"),r=document.getElementById("company-name"),m=document.getElementById("vatin");function E(){const t=!!i?.checked;y&&y.classList.toggle("hidden",!t),r&&(r.required=t),m&&(m.required=t)}i?.addEventListener("change",E);E();const e=document.getElementById("wsContinue");e?.addEventListener("click",async()=>{const t=document.querySelector("form");if(t&&!t.reportValidity())return;const o=JSON.parse(sessionStorage.getItem("wsCheckoutDraft")||"{}"),n={seats:p(Number.isFinite(c)?c:o?.seats??1),email:(T?.value??"").trim()||o?.customer?.email||null,billingAddress:{line1:(v?.value??"").trim(),city:(k?.value??"").trim(),postal_code:(x?.value??"").trim(),country:B(b?.value||"")},company:i?.checked?{name:(r?.value??"").trim(),vatin:(m?.value??"").trim()}:null};try{sessionStorage.setItem("wsCheckoutDraft",JSON.stringify({seats:n.seats,customer:{email:n.email},address:n.billingAddress,company:n.company}))}catch{}const h=e.textContent;e.disabled=!0,e.style.opacity="0.7",e.textContent="Processingâ€¦";try{const a=await(await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();if(a?.url)window.location.href=a.url;else throw new Error(a?.error||"Could not start payment")}catch(s){console.error(s.message||String(s)),e.disabled=!1,e.style.opacity="",e.textContent=h}});
